(this["webpackJsonpmobile-pwa"]=this["webpackJsonpmobile-pwa"]||[]).push([[0],{210:function(e,a,t){e.exports=t(431)},215:function(e,a,t){},423:function(e,a){},431:function(e,a,t){"use strict";t.r(a);var n=t(0),c=t.n(n),r=t(82),o=t.n(r),i=(t(215),t(125)),l=t(37),f=Object(n.createContext)(),s=function(e){var a=e.reducer,t=e.initialState,r=e.children;return c.a.createElement(f.Provider,{value:Object(n.useReducer)(a,t)},r)},m=function(){return Object(n.useContext)(f)},u=t(83),d="auth/LOGIN",p="auth/CLEAR_USER",E=window.localStorage.getItem("auth0ExpiresIn"),h={authenticated:E&&E-(new Date).getTime()/1e3>0,profile:null},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case d:return Object(u.a)({},e,{authenticated:!0});case p:return Object(u.a)({},h);case"auth/SET_USER_PROFILE":return Object(u.a)({},e,{profile:a.payload});default:return e}},g=function(e,a){var t=e.auth;return{auth:v(t,a)}},N=t(11),b=t(209),O=function(e){var a=e.component,t=Object(b.a)(e,["component"]),n=m(),r=Object(N.a)(n,1)[0].auth;return c.a.createElement(l.b,Object.assign({},t,{render:function(e){return r.authenticated?c.a.createElement(a,e):c.a.createElement(l.a,{to:{pathname:"/",state:{from:e.location}}})}}))},x=t(24),w=t.n(x),_=t(43),j=t(124),S=t.n(j),y=function(){var e=m(),a=Object(N.a)(e,2),t=a[0].auth,n=a[1],c=new S.a("4sh93YHeF9hWItsRv9qHQH31tudFKDpY","dev-l7c1wrq9.au.auth0.com",{auth:{audience:"https://localhost:5000"}});c.on("authenticated",(function(e){var a=(new Date).getTime()/1e3+e.expiresIn;window.localStorage.setItem("auth0ExpiresIn",a),window.localStorage.setItem("auth0AccessToken",e.accessToken),c.hide(),n({type:d})}));return[t,{signIn:function(){c.show()},siginOut:function(){var e=Object(_.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.logout();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getUserProfile:function(){var e=window.localStorage.getItem("auth0AccessToken");c.getUserInfo(e,(function(e,a){n(function(e){return{type:"auth/SET_USER_PROFILE",payload:e}}(a))}))}}]},I=function(e){var a=(e.location.state||{from:{pathname:"/home"}}).from,t=y(),r=Object(N.a)(t,2),o=r[0],i=r[1].signIn;return Object(n.useEffect)((function(){o.authenticated?e.history.push(a):i()}),[o]),c.a.createElement("div",null)},k=t(35),C=t(36);function T(){var e=Object(k.a)(["\n  display: flex;\n  justify-content: center;\n  margin: auto;\n  margin-top: 50px;\n  flex-direction: column;\n  width: 60%;\n  padding: 10px;\n  height: fit-content;\n\n  .coffee-card_row {\n    width: 100%;\n    display: flex;\n    justify-content: space-around;\n    margin: 15px;\n  }\n  .coffee-card_item {\n    font-size: 35px;\n    color: white;\n    margin-left: 10px;\n    margin-right: 10px;\n  }\n  .coffee-card_item_even {\n    font-size: 35px;\n    color: #f08080;\n    margin-left: 10px;\n    margin-right: 10px;\n  }\n"]);return T=function(){return e},e}var R=C.a.div(T()),D=function(){return c.a.createElement(R,null,c.a.createElement("div",{className:"coffee-card_row"},c.a.createElement("div",{className:"coffee-card_item_even"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item_even"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item_even"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item_even"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item_even"},c.a.createElement("i",{className:"fa fa-heart"}))),c.a.createElement("div",{className:"coffee-card_row"},c.a.createElement("div",{className:"coffee-card_item"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item"},c.a.createElement("i",{className:"fa fa-heart"}))),c.a.createElement("div",{className:"coffee-card_row"},c.a.createElement("div",{className:"coffee-card_item"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item"},c.a.createElement("i",{className:"fa fa-heart"}))),c.a.createElement("div",{className:"coffee-card_row"},c.a.createElement("div",{className:"coffee-card_item"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item"},c.a.createElement("i",{className:"fa fa-coffee"})),c.a.createElement("div",{className:"coffee-card_item"},c.a.createElement("i",{className:"fa fa-heart"}))))};function P(){var e=Object(k.a)(["\n  background-color: #b33939;\n  width: 90%;\n  max-width: 500px;\n  border: none;\n  color: white;\n  padding: 15px 32px;\n  text-align: center;\n  text-decoration: none;\n  display: block;\n  font-size: 25px;\n  font-weight: bold;\n  border-radius: 10px;\n  position: fixed;\n  margin: auto;\n  bottom: 150px;\n  cursor: pointer;\n\n  i {\n    margin-right: 10px;\n    font-size: 25px;\n  }\n"]);return P=function(){return e},e}var U=C.a.button(P()),A=function(e){var a=e.text,t=e.callback;return c.a.createElement(U,{type:"button",onClick:t},c.a.createElement("i",{className:"fa fa-qrcode"}),a)};function z(){var e=Object(k.a)(["\n  display: flex;\n  justify-content: center;\n  margin: auto;\n  margin-top: 80px;\n  font-weight: bold;\n  font-size: 35px;\n  font-family: fantasy;\n"]);return z=function(){return e},e}var F=C.a.div(z()),L=function(e){var a=e.text;return c.a.createElement(F,null,a)};function J(){var e=Object(k.a)(["\n  background-color: #c7ecee;\n  width: 100%;\n  display: block;\n  max-width: 500px;\n  margin: 0 auto;\n  padding-top: 20px;\n  text-align: center;\n  height: 100vh;\n"]);return J=function(){return e},e}var V=C.a.div(J()),G=t(207),q=t.n(G),B={CORE_SERVICE_ENDPOINT:"https://loyal-card-core-service.herokuapp.com"},H=function(){var e=Object(n.useState)(null),a=Object(N.a)(e,2),t=a[0],c=a[1],r=Object(n.useState)(!1),o=Object(N.a)(r,2),i=o[0],l=o[1],f=Object(n.useState)(!1),s=Object(N.a)(f,2),u=s[0],d=s[1],p=Object(n.useState)(null),E=Object(N.a)(p,2),h=(E[0],E[1]),v=m(),g=Object(N.a)(v,1)[0].auth,b=B.CORE_SERVICE_ENDPOINT,O=q()(b),x=g.profile&&g.profile.email;return O.on("FromAPI-".concat(x),(function(e){console.log(e),h(e)})),[{codeUrl:t,loading:i,error:u},function(){var e=Object(_.a)(w.a.mark((function e(a){var t,n,r,o;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),t=window.localStorage.getItem("accessToken"),e.prev=2,e.next=5,fetch("".concat(B.CORE_SERVICE_ENDPOINT,"/api/code/get-code"),{method:"GET",headers:{ContentType:"application/json",Authorization:"Bearer "+t}});case 5:return n=e.sent,e.next=8,n.text();case 8:r=e.sent,o=g.profile&&g.profile.email,c("".concat(r,"&email=").concat(o,"&method=").concat(a)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),d(e.t0);case 16:l(!1);case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(a){return e.apply(this,arguments)}}()]},W=function(){var e=Object(n.useState)(null),a=Object(N.a)(e,2),t=a[0],c=a[1],r=Object(n.useState)(!1),o=Object(N.a)(r,2),i=o[0],l=o[1],f=Object(n.useState)(!1),s=Object(N.a)(f,2),m=s[0],u=s[1],d=Object(n.useState)(!1),p=Object(N.a)(d,2),E=p[0],h=p[1];return[{customerDetail:t,customerDetailChecked:i,profileLoading:m,dataError:E},{fetchCustomerDetails:function(){var e=Object(_.a)(w.a.mark((function e(a){var t,n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),l(!1),window.localStorage.getItem("accessToken"),e.prev=3,e.next=6,fetch("".concat(B.CORE_SERVICE_ENDPOINT,"/api/customers/get?email=").concat(a),{method:"GET"});case 6:if(!(t=e.sent).ok){e.next=12;break}return e.next=10,t.json();case 10:n=e.sent,c(n);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),h(!0);case 17:u(!1),l(!0);case 19:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(a){return e.apply(this,arguments)}}(),createCustomer:function(){var e=Object(_.a)(w.a.mark((function e(a,t){var n,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),window.localStorage.getItem("accessToken"),e.prev=2,e.next=5,fetch("".concat(B.CORE_SERVICE_ENDPOINT,"/api/customers/"),{method:"POST",body:JSON.stringify({username:a,email:t}),headers:{"Content-Type":"application/json"}});case 5:return n=e.sent,e.next=8,n.json();case 8:r=e.sent,c(r),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),h(!0);case 15:u(!1);case 16:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(a,t){return e.apply(this,arguments)}}()}]},Y=t(208),K=t.n(Y),M=function(e){var a=H(),t=Object(N.a)(a,2),r=t[0],o=r.codeUrl,i=(r.loading,r.error,t[1]),l=W(),f=Object(N.a)(l,2),s=f[0],m=s.customerDetail,u=s.customerDetailChecked,d=(s.profileLoading,s.dataError,f[1]),p=d.fetchCustomerDetails,E=d.createCustomer,h=y(),v=Object(N.a)(h,2),g=v[0],b=v[1],O=(b.signIn,b.siginOut,b.getUserProfile);return Object(n.useEffect)((function(){console.log(JSON.stringify(g.profile)),g.profile||O(),g.profile&&!m&&(console.log(JSON.stringify(g.profile)),u?E(g.profile.username,g.profile.email):p(g.profile.email))}),[o,g.profile,u,m]),c.a.createElement(V,null,c.a.createElement(L,{text:"CAFE NAME"}),c.a.createElement(D,null),c.a.createElement(A,{text:"GET CODE",callback:function(){return i("purchase")}}),o&&c.a.createElement(K.a,{value:o}))},Q=function(e){var a={auth:h};return c.a.createElement(s,{initialState:a,reducer:g},c.a.createElement(i.a,null,c.a.createElement(l.d,null,c.a.createElement(l.b,{exact:!0,path:"/",component:I}),c.a.createElement(O,{path:"/home",component:M}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(Q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[210,1,2]]]);
//# sourceMappingURL=main.a46fb0d7.chunk.js.map